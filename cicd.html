<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub CI/CD Deployment Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(30, 41, 59, 0.7);
            border-radius: 20px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .title {
            font-size: 2.8rem;
            background: linear-gradient(90deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #94a3b8;
            font-size: 1.2rem;
            font-weight: 400;
        }

        .timeline {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-bottom: 50px;
        }

        .step {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 16px;
            padding: 25px;
            border-left: 5px solid #60a5fa;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .step:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .step-number {
            display: inline-block;
            background: #3b82f6;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            text-align: center;
            line-height: 36px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .step-title {
            font-size: 1.5rem;
            color: #f1f5f9;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-content {
            color: #cbd5e1;
            margin-bottom: 20px;
        }

        .code-block {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid #334155;
            overflow-x: auto;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #475569;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }

        .copy-btn:hover {
            background: #64748b;
        }

        .copy-btn.copied {
            background: #10b981;
        }

        pre {
            color: #e2e8f0;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        .command {
            color: #34d399;
        }

        .comment {
            color: #94a3b8;
        }

        .path {
            color: #fbbf24;
        }

        .variable {
            color: #60a5fa;
        }

        .string {
            color: #f472b6;
        }

        .note {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .terminal {
            background: #0f172a;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #334155;
        }

        .terminal-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: #94a3b8;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .terminal-dot.red { background: #ef4444; }
        .terminal-dot.yellow { background: #f59e0b; }
        .terminal-dot.green { background: #10b981; }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #94a3b8;
            font-size: 0.9rem;
            border-top: 1px solid #334155;
        }

        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .success-message.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .step {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="success-message" id="successMessage">‚úÖ Code copied to clipboard!</div>
    
    <div class="container">
        <div class="header">
            <h1 class="title">üöÄ GitHub CI/CD Deployment Guide</h1>
            <p class="subtitle">Complete Node.js + PM2 + GitHub Actions Deployment Workflow</p>
        </div>

        <div class="timeline">
            <!-- Step 1 -->
            <div class="step">
                <div class="step-number">1</div>
                <h2 class="step-title">üñ•Ô∏è Initial Server Setup</h2>
                <div class="step-content">
                    <p>First, install necessary software on your VPS:</p>
                    <div class="code-block">
                        <button class="copy-btn" data-code="step1">Copy Code</button>
                        <pre><code><span class="comment"># Update system and install Git, Node.js, PM2</span>
<span class="command">sudo apt update && sudo apt upgrade -y</span>
<span class="command">sudo apt install git -y</span>

<span class="comment"># Install Node.js using NVM (Recommended)</span>
<span class="command">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span>
<span class="command">source ~/.bashrc</span>
<span class="command">nvm install --lts</span>

<span class="comment"># Install PM2 globally</span>
<span class="command">npm install -g pm2</span>

<span class="comment"># Generate SSH key for GitHub Actions</span>
<span class="command">ssh-keygen -t rsa -b 4096</span>
<span class="command">cat ~/.ssh/id_rsa.pub</span></code></pre>
                    </div>
                    <div class="note">
                        üí° <strong>Note:</strong> Copy the public SSH key from the last command. You'll need it for GitHub Secrets.
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="step">
                <div class="step-number">2</div>
                <h2 class="step-title">üîê Configure GitHub Secrets</h2>
                <div class="step-content">
                    <p>Go to your GitHub repository ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions:</p>
                    <div class="code-block">
                        <button class="copy-btn" data-code="step2">Copy Instructions</button>
                        <pre><code>Add these secrets:

<span class="variable">SERVER_HOST</span> = <span class="string">"your-server-ip-address"</span>
<span class="variable">SERVER_SSH_KEY</span> = <span class="string">"-----BEGIN RSA PRIVATE KEY-----\n[Your private key]\n-----END RSA PRIVATE KEY-----"</span>
<span class="variable">SERVER_USERNAME</span> = <span class="string">"root"</span> <span class="comment"># or your username</span></code></pre>
                    </div>
                    <div class="note">
                        ‚ö†Ô∏è <strong>Important:</strong> The SSH key must be the <strong>PRIVATE KEY</strong> (id_rsa) from your server, not the public key!
                    </div>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="step">
                <div class="step-number">3</div>
                <h2 class="step-title">üìÅ Create GitHub Actions Workflow</h2>
                <div class="step-content">
                    <p>In your project, create: <span class="path">.github/workflows/deploy.yml</span></p>
                    <div class="code-block">
                        <button class="copy-btn" data-code="step3">Copy Code</button>
                        <pre><code><span class="variable">name</span>: Deploy to Server

<span class="variable">on</span>:
  <span class="variable">push</span>:
    <span class="variable">branches</span>: [ main ]
  <span class="variable">pull_request</span>:
    <span class="variable">branches</span>: [ main ]

<span class="variable">jobs</span>:
  <span class="variable">deploy</span>:
    <span class="variable">runs-on</span>: ubuntu-latest
    
    <span class="variable">steps</span>:
      - <span class="variable">name</span>: Checkout code
        <span class="variable">uses</span>: actions/checkout@v3
      
      - <span class="variable">name</span>: Deploy to Server
        <span class="variable">uses</span>: appleboy/ssh-action@v1
        <span class="variable">with</span>:
          <span class="variable">host</span>: ${{ secrets.SERVER_HOST }}
          <span class="variable">username</span>: ${{ secrets.SERVER_USERNAME }}
          <span class="variable">key</span>: ${{ secrets.SERVER_SSH_KEY }}
          <span class="variable">port</span>: 22
          <span class="variable">script</span>: |
            <span class="comment"># Load NVM</span>
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
            
            <span class="comment"># Navigate to project directory</span>
            cd /root/your-project  <span class="comment"># Change this to your project path</span>
            
            <span class="comment"># Pull latest code</span>
            git pull origin main
            
            <span class="comment"># Install dependencies</span>
            npm install
            
            <span class="comment"># Generate Prisma client (if using Prisma)</span>
            npx prisma generate
            
            <span class="comment"># Build the project</span>
            npm run build
            
            <span class="comment"># Restart with PM2</span>
            pm2 restart your-project  <span class="comment"># Change to your PM2 app name</span></code></pre>
                    </div>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="step">
                <div class="step-number">4</div>
                <h2 class="step-title">üîÑ First-Time Manual Setup</h2>
                <div class="step-content">
                    <p>For the first deployment, you need to manually set up on the server:</p>
                    <div class="terminal">
                        <div class="terminal-header">
                            <div class="terminal-dot red"></div>
                            <div class="terminal-dot yellow"></div>
                            <div class="terminal-dot green"></div>
                            <span>VPS Terminal</span>
                        </div>
                        <pre><code><span class="command"># Clone your repository</span>
git clone https://github.com/your-username/your-repo.git
cd your-repo

<span class="command"># Install dependencies</span>
npm install

<span class="command"># Set up environment variables</span>
cp .env.example .env
nano .env  <span class="comment"># Edit with your config</span>

<span class="command"># Generate Prisma client</span>
npx prisma generate

<span class="command"># Build the project</span>
npm run build

<span class="command"># Start with PM2</span>
pm2 start npm --name "your-project" -- start
<span class="command"># Or if you have ecosystem.config.js</span>
pm2 start ecosystem.config.js

<span class="command"># Save PM2 process list</span>
pm2 save

<span class="command"># Setup PM2 to start on boot</span>
pm2 startup
<span class="comment"># Follow the instructions shown</span></code></pre>
                    </div>
                </div>
            </div>

            <!-- Step 5 -->
            <div class="step">
                <div class="step-number">5</div>
                <h2 class="step-title">üöÄ Test Your CI/CD Pipeline</h2>
                <div class="step-content">
                    <p>Make a change and push to trigger the deployment:</p>
                    <div class="terminal">
                        <div class="terminal-header">
                            <div class="terminal-dot red"></div>
                            <div class="terminal-dot yellow"></div>
                            <div class="terminal-dot green"></div>
                            <span>Local Terminal</span>
                        </div>
                        <pre><code><span class="command"># Add your changes</span>
git add .

<span class="command"># Commit with descriptive message</span>
git commit -m "feat: add CI/CD deployment setup"

<span class="command"># Push to GitHub</span>
git push origin main</code></pre>
                    </div>
                    <div class="note">
                        üìä <strong>Monitor:</strong> Go to your GitHub repository ‚Üí Actions tab to see the deployment progress in real-time.
                    </div>
                </div>
            </div>

            <!-- Step 6 -->
            <div class="step">
                <div class="step-number">6</div>
                <h2 class="step-title">üîß Troubleshooting Common Issues</h2>
                <div class="step-content">
                    <p>If deployment fails, check these common solutions:</p>
                    <div class="code-block">
                        <pre><code><span class="comment"># 1. Permission issues</span>
<span class="command">chmod 600 ~/.ssh/id_rsa</span>
<span class="command">chmod 700 ~/.ssh</span>

<span class="comment"># 2. Node.js not found in CI</span>
<span class="comment"># Add this to deploy.yml before npm install:</span>
- <span class="variable">name</span>: Setup Node.js
  <span class="variable">uses</span>: actions/setup-node@v3
  <span class="variable">with</span>:
    <span class="variable">node-version</span>: '18'

<span class="comment"># 3. PM2 not found</span>
<span class="command">npm install -g pm2</span>
<span class="command"># Or add to PATH in script:</span>
export PATH="$PATH:/usr/bin/pm2"

<span class="comment"># 4. Check GitHub Actions logs</span>
<span class="comment"># Go to: https://github.com/username/repo/actions</span></code></pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>üéâ Your CI/CD pipeline is now ready! Every push to main branch will automatically deploy to your server.</p>
            <p>Made with ‚ù§Ô∏è using Sundor UI Style | Copy-friendly design</p>
        </div>
    </div>

    <script>
        // Copy to clipboard functionality
        document.querySelectorAll('.copy-btn').forEach(button => {
            button.addEventListener('click', function() {
                const codeBlock = this.parentElement.querySelector('pre code');
                const codeToCopy = codeBlock.textContent;
                
                navigator.clipboard.writeText(codeToCopy).then(() => {
                    // Show success message
                    const successMessage = document.getElementById('successMessage');
                    successMessage.classList.add('show');
                    
                    // Change button text
                    const originalText = this.textContent;
                    this.textContent = '‚úÖ Copied!';
                    this.classList.add('copied');
                    
                    setTimeout(() => {
                        successMessage.classList.remove('show');
                        this.textContent = originalText;
                        this.classList.remove('copied');
                    }, 2000);
                });
            });
        });

        // Predefined code blocks for copy function
        const codeSnippets = {
            step1: `# Update system and install Git, Node.js, PM2
sudo apt update && sudo apt upgrade -y
sudo apt install git -y

# Install Node.js using NVM (Recommended)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install --lts

# Install PM2 globally
npm install -g pm2

# Generate SSH key for GitHub Actions
ssh-keygen -t rsa -b 4096
cat ~/.ssh/id_rsa.pub`,

            step2: `Add these secrets:

SERVER_HOST = "your-server-ip-address"
SERVER_SSH_KEY = "-----BEGIN RSA PRIVATE KEY-----\n[Your private key]\n-----END RSA PRIVATE KEY-----"
SERVER_USERNAME = "root" # or your username`,

            step3: `name: Deploy to Server

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Deploy to Server
        uses: appleboy/ssh-action@v1
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USERNAME }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          port: 22
          script: |
            # Load NVM
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
            
            # Navigate to project directory
            cd /root/your-project  # Change this to your project path
            
            # Pull latest code
            git pull origin main
            
            # Install dependencies
            npm install
            
            # Generate Prisma client (if using Prisma)
            npx prisma generate
            
            # Build the project
            npm run build
            
            # Restart with PM2
            pm2 restart your-project  # Change to your PM2 app name`
        };
    </script>
</body>
</html>